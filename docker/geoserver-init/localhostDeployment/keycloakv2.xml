<filter>
  <name>keycloak-auth</name>
  <className>org.geoserver.security.oauth2.OpenIdConnectAuthenticationFilter</className>

  <configuration>
    <openIdConnectAuthentication>
      <name>keycloak-auth</name>
      <roleSource>AccessToken</roleSource>
      <clientId>geoserver</clientId>
      <clientSecret>kdiPeHpRHCy5VRQJugM77QlXa7jo2SA1</clientSecret>

      <accessTokenUri>
        https://auth.dcs.hcu-hamburg.de/realms/geoserver-realm/protocol/openid-connect/token
      </accessTokenUri>

      <userAuthorizationUri>
        https://auth.dcs.hcu-hamburg.de/realms/geoserver-realm/protocol/openid-connect/auth
      </userAuthorizationUri>

      <redirectUri>http://localhost:8080/geoserver/</redirectUri>

      <checkTokenEndpointUrl>
        https://auth.dcs.hcu-hamburg.de/realms/geoserver-realm/protocol/openid-connect/userinfo
      </checkTokenEndpointUrl>

      <logoutUri>
        https://auth.dcs.hcu-hamburg.de/realms/geoserver-realm/protocol/openid-connect/logout
      </logoutUri>

      <scopes>openid profile email</scopes>
      <principalKey>preferred_username</principalKey>
      <tokenRolesClaim>realm_access.roles</tokenRolesClaim>

      <usePKCE>true</usePKCE>
      <allowBearerTokens>true</allowBearerTokens>
    </openIdConnectAuthentication>
  </configuration>
</filter>